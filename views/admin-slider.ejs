<%- include('partials/head', { title }) %>
<%- include('partials/navbar') %>

<main class="mx-auto flex w-full max-w-5xl flex-1 flex-col gap-8 px-4 py-10 sm:px-6 lg:px-8">
  <header class="flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
    <div>
      <h1 class="text-3xl font-semibold text-primary-700">จัดการภาพสไลด์หน้าแรก</h1>
      <p class="mt-1 text-sm text-slate-600">
        เพิ่ม แก้ไข หรือจัดลำดับภาพสไลด์ที่แสดงบนหน้าแรกของเว็บไซต์
      </p>
    </div>
    <a
      href="/admin/slider/new"
      class="inline-flex items-center gap-2 rounded-xl bg-primary-600 px-5 py-2.5 text-sm font-medium text-white shadow-sm transition hover:-translate-y-0.5 hover:bg-primary-700"
    >
      <svg class="h-4 w-4 text-white/90" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
      </svg>
      เพิ่มสไลด์ใหม่
    </a>
  </header>

  <%- include('partials/flash') %>

  <section class="rounded-3xl bg-white/90 shadow-sm ring-1 ring-black/5 backdrop-blur">
    <% if (sliders && sliders.length) { %>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-slate-200 text-sm">
          <thead class="bg-slate-50 text-xs uppercase tracking-wide text-slate-500">
            <tr>
              <th scope="col" class="px-4 py-3 text-left">ภาพตัวอย่าง</th>
              <th scope="col" class="px-4 py-3 text-left">หัวข้อ</th>
              <th scope="col" class="px-4 py-3 text-left">ลิงก์</th>
              <th scope="col" class="px-4 py-3 text-left">ลำดับแสดง</th>
              <th scope="col" class="px-4 py-3 text-left">สถานะ</th>
              <th scope="col" class="px-4 py-3 text-left">อัปเดตล่าสุด</th>
              <th scope="col" class="px-4 py-3 text-center">การจัดการ</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-100">
            <% sliders.forEach((item) => { %>
              <tr class="hover:bg-slate-50/70">
                <td class="px-4 py-3">
                  <% if (item.imagePath) { %>
                    <img
                      src="/<%= item.imagePath %>"
                      alt="<%= item.title %>"
                      class="h-16 w-28 rounded-lg object-cover ring-1 ring-slate-200"
                    />
                  <% } else { %>
                    <span class="text-xs text-slate-400">ไม่มีภาพ</span>
                  <% } %>
                </td>
                <td class="px-4 py-3 font-medium text-slate-700">
                  <p><%= item.title %></p>
                  <% if (item.caption) { %>
                    <p class="mt-1 text-xs text-slate-500 line-clamp-2"><%= item.caption %></p>
                  <% } %>
                </td>
                <td class="px-4 py-3 text-xs text-primary-600">
                  <% if (item.link) { %>
                    <a href="<%= item.link %>" target="_blank" rel="noopener" class="hover:underline"><%= item.link %></a>
                  <% } else { %>
                    <span class="text-slate-400">-</span>
                  <% } %>
                </td>
                <td class="px-4 py-3 text-slate-600">
                  <%= item.displayOrder %>
                </td>
                <td class="px-4 py-3">
                  <% if (item.isActive) { %>
                    <span class="inline-flex items-center gap-1 rounded-full bg-emerald-100 px-2.5 py-1 text-xs font-semibold text-emerald-600">
                      <span class="h-2 w-2 rounded-full bg-emerald-500"></span>
                      แสดงผล
                    </span>
                  <% } else { %>
                    <span class="inline-flex items-center gap-1 rounded-full bg-slate-200 px-2.5 py-1 text-xs font-semibold text-slate-600">
                      <span class="h-2 w-2 rounded-full bg-slate-500"></span>
                      ซ่อนอยู่
                    </span>
                  <% } %>
                </td>
                <td class="px-4 py-3 text-slate-500">
                  <%= new Date(item.updatedAt).toLocaleString('th-TH', { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' }) %>
                </td>
                <td class="px-4 py-3">
                  <div class="flex items-center justify-center gap-2">
                    <a
                      href="/admin/slider/<%= item.id %>/edit"
                      class="inline-flex items-center gap-1 rounded-md border border-primary-200 px-3 py-1 text-xs font-medium text-primary-600 transition hover:bg-primary-50"
                    >
                      <svg class="h-3.5 w-3.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232a2.5 2.5 0 1 1 3.536 3.536L8.5 19.036 4 20l.964-4.5 10.268-10.268Z" />
                      </svg>
                      แก้ไข
                    </a>
                    <form action="/admin/slider/<%= item.id %>/delete" method="post">
                      <button
                        type="submit"
                        data-confirm-message="ยืนยันการลบภาพสไลด์นี้หรือไม่?"
                        class="inline-flex items-center gap-1 rounded-md bg-rose-500 px-3 py-1 text-xs font-medium text-white transition hover:bg-rose-600"
                      >
                        <svg class="h-3.5 w-3.5 text-white/80" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6m0 12L6 6" />
                        </svg>
                        ลบ
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } else { %>
      <div class="px-8 py-16 text-center text-slate-500">
        ยังไม่มีภาพสไลด์ในระบบ เริ่มต้นด้วยการเพิ่มสไลด์ใหม่
      </div>
    <% } %>
  </section>
</main>

<%- include('partials/footer') %>
